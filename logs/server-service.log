
> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
Attention: Next.js now collects completely anonymous telemetry regarding usage.
This information is used to shape Next.js' roadmap and prioritize features.
You can learn more, including how to opt-out if you'd not like to participate in this anonymous program, by visiting the following URL:
https://nextjs.org/telemetry

 ‚úì Ready in 784ms
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJEN0FCODlDQUFFRTJGRDA2NTcA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 407ms (compile: 285ms, render: 123ms)
 GET / 200 in 1582ms (compile: 1490ms, render: 92ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1205ms (compile: 2ms, render: 1202ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxRjYyNDU0NDBDMTQ4Q0U4MTQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 43ms (compile: 1973¬µs, render: 41ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxRjYyNDU0NDBDMTQ4Q0U4MTQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 40ms (compile: 2ms, render: 37ms)
®Desea terminar el trabajo por lotes (S/N)? [?25h

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 2.7s
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIwMTY2Q0I2NkZDOEVDQURDQzYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 635ms (compile: 456ms, render: 179ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBIyNzg4NTJEMzE0RjI0MEU4MzgA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 48ms (compile: 3ms, render: 45ms)
 GET / 200 in 1993ms (compile: 1898ms, render: 95ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 2.1s (compile: 2ms, render: 2.1s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJBRTc3NDA5NDkzRTkxOEQ3OEIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 34ms (compile: 1952¬µs, render: 32ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJBRTc3NDA5NDkzRTkxOEQ3OEIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 34ms (compile: 1793¬µs, render: 32ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJBRTc3NDA5NDkzRTkxOEQ3OEIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 27ms (compile: 1498¬µs, render: 25ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚ö†Ô∏è Pr√≥ximo a cerrar - Se enviar√° aviso con la respuesta
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: mistral
ü§ñ IA proces√≥ mensaje - Intent: undefined, Sentiment: undefined
üí¨ Respuesta IA: Lo siento, tuve un problema procesando tu mensaje. Por favor intenta de nuevo.
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 923ms (compile: 2ms, render: 921ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI1QTE5RTI5NzlDQzg1MTFBQ0IA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 3ms, render: 30ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI1QTE5RTI5NzlDQzg1MTFBQ0IA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 1840¬µs, render: 31ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚ö†Ô∏è Pr√≥ximo a cerrar - Se enviar√° aviso con la respuesta
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: mistral
ü§ñ IA proces√≥ mensaje - Intent: undefined, Sentiment: undefined
üí¨ Respuesta IA: Lo siento, tuve un problema procesando tu mensaje. Por favor intenta de nuevo.
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 901ms (compile: 1701¬µs, render: 899ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2MDIwODc4N0ZDOTZGODY2MEUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 30ms (compile: 1566¬µs, render: 28ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2MDIwODc4N0ZDOTZGODY2MEUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 30ms (compile: 1473¬µs, render: 28ms)
üå± Iniciando seed de la base de datos...
Creating commands...
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
Creating message templates...
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
Creating system config...
prisma:query INSERT INTO `main`.`SystemConfig` (`id`, `key`, `value`, `type`, `description`, `updatedAt`) VALUES (?,?,?,?,?,?) ON CONFLICT  (`key`) DO UPDATE SET `key` = ?, `value` = ?, `type` = ?, `description` = ?, `updatedAt` = ? WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) RETURNING `id` AS `id`, `key` AS `key`, `value` AS `value`, `type` AS `type`, `description` AS `description`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`SystemConfig` (`id`, `key`, `value`, `type`, `description`, `updatedAt`) VALUES (?,?,?,?,?,?) ON CONFLICT  (`key`) DO UPDATE SET `key` = ?, `value` = ?, `type` = ?, `description` = ?, `updatedAt` = ? WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) RETURNING `id` AS `id`, `key` AS `key`, `value` AS `value`, `type` AS `type`, `description` AS `description`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`SystemConfig` (`id`, `key`, `value`, `type`, `description`, `updatedAt`) VALUES (?,?,?,?,?,?) ON CONFLICT  (`key`) DO UPDATE SET `key` = ?, `value` = ?, `type` = ?, `description` = ?, `updatedAt` = ? WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) RETURNING `id` AS `id`, `key` AS `key`, `value` AS `value`, `type` AS `type`, `description` AS `description`, `updatedAt` AS `updatedAt`
‚úÖ Seed completado exitosamente!
 POST /api/admin/seed 200 in 242ms (compile: 82ms, render: 159ms)
üå± Iniciando seed de la base de datos...
Creating commands...
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
Creating message templates...
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
Creating system config...
prisma:query INSERT INTO `main`.`SystemConfig` (`id`, `key`, `value`, `type`, `description`, `updatedAt`) VALUES (?,?,?,?,?,?) ON CONFLICT  (`key`) DO UPDATE SET `key` = ?, `value` = ?, `type` = ?, `description` = ?, `updatedAt` = ? WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) RETURNING `id` AS `id`, `key` AS `key`, `value` AS `value`, `type` AS `type`, `description` AS `description`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`SystemConfig` (`id`, `key`, `value`, `type`, `description`, `updatedAt`) VALUES (?,?,?,?,?,?) ON CONFLICT  (`key`) DO UPDATE SET `key` = ?, `value` = ?, `type` = ?, `description` = ?, `updatedAt` = ? WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) RETURNING `id` AS `id`, `key` AS `key`, `value` AS `value`, `type` AS `type`, `description` AS `description`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`SystemConfig` (`id`, `key`, `value`, `type`, `description`, `updatedAt`) VALUES (?,?,?,?,?,?) ON CONFLICT  (`key`) DO UPDATE SET `key` = ?, `value` = ?, `type` = ?, `description` = ?, `updatedAt` = ? WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) RETURNING `id` AS `id`, `key` AS `key`, `value` AS `value`, `type` AS `type`, `description` AS `description`, `updatedAt` AS `updatedAt`
‚úÖ Seed completado exitosamente!
 POST /api/admin/seed 200 in 197ms (compile: 43ms, render: 154ms)
üå± Iniciando seed de la base de datos...
Creating commands...
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`Command` (`id`, `trigger`, `name`, `description`, `response`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`trigger`) DO UPDATE SET `trigger` = ?, `name` = ?, `description` = ?, `response` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`Command`.`trigger` = ? AND 1=1) RETURNING `id` AS `id`, `trigger` AS `trigger`, `name` AS `name`, `description` AS `description`, `response` AS `response`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `lastUsed` AS `lastUsed`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
Creating message templates...
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`MessageTemplate` (`id`, `name`, `category`, `language`, `content`, `isActive`, `usageCount`, `createdAt`, `updatedAt`) VALUES (?,?,?,?,?,?,?,?,?) ON CONFLICT  (`name`) DO UPDATE SET `name` = ?, `category` = ?, `language` = ?, `content` = ?, `isActive` = ?, `updatedAt` = ? WHERE (`main`.`MessageTemplate`.`name` = ? AND 1=1) RETURNING `id` AS `id`, `name` AS `name`, `category` AS `category`, `language` AS `language`, `content` AS `content`, `variables` AS `variables`, `isActive` AS `isActive`, `usageCount` AS `usageCount`, `createdAt` AS `createdAt`, `updatedAt` AS `updatedAt`
Creating system config...
prisma:query INSERT INTO `main`.`SystemConfig` (`id`, `key`, `value`, `type`, `description`, `updatedAt`) VALUES (?,?,?,?,?,?) ON CONFLICT  (`key`) DO UPDATE SET `key` = ?, `value` = ?, `type` = ?, `description` = ?, `updatedAt` = ? WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) RETURNING `id` AS `id`, `key` AS `key`, `value` AS `value`, `type` AS `type`, `description` AS `description`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`SystemConfig` (`id`, `key`, `value`, `type`, `description`, `updatedAt`) VALUES (?,?,?,?,?,?) ON CONFLICT  (`key`) DO UPDATE SET `key` = ?, `value` = ?, `type` = ?, `description` = ?, `updatedAt` = ? WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) RETURNING `id` AS `id`, `key` AS `key`, `value` AS `value`, `type` AS `type`, `description` AS `description`, `updatedAt` AS `updatedAt`
prisma:query INSERT INTO `main`.`SystemConfig` (`id`, `key`, `value`, `type`, `description`, `updatedAt`) VALUES (?,?,?,?,?,?) ON CONFLICT  (`key`) DO UPDATE SET `key` = ?, `value` = ?, `type` = ?, `description` = ?, `updatedAt` = ? WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) RETURNING `id` AS `id`, `key` AS `key`, `value` AS `value`, `type` AS `type`, `description` AS `description`, `updatedAt` AS `updatedAt`
‚úÖ Seed completado exitosamente!
 POST /api/admin/seed 200 in 181ms (compile: 23ms, render: 158ms)
prisma:query SELECT 1
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
 GET /api/admin/ollama 200 in 125ms (compile: 113ms, render: 12ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚ö†Ô∏è Pr√≥ximo a cerrar - Se enviar√° aviso con la respuesta
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
 POST /api/whatsapp/webhook 200 in 24.8s (compile: 1741¬µs, render: 24.8s)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Unique constraint failed on the fields: (`whatsappId`)
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `error` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 66ms (compile: 1772¬µs, render: 64ms)
‚úÖ Respuesta generada (144 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: saludo, Sentiment: neutral
üí¨ Respuesta IA: ¬°Hola! ¬øEn qu√© puedo ayudarte hoy? Si est√°s buscando informaci√≥n sobre nuestros horarios o tienes alguna otra consulta, no dudes en dec√≠rmelo.üòä
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJDMjg4QTg1QzQ1QzAyQ0UyMEMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 37ms (compile: 1669¬µs, render: 36ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJDMjg4QTg1QzQ1QzAyQ0UyMEMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 30ms (compile: 1686¬µs, render: 28ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola buenas noches
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚ö†Ô∏è Pr√≥ximo a cerrar - Se enviar√° aviso con la respuesta
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
 POST /api/whatsapp/webhook 200 in 24.8s (compile: 3ms, render: 24.8s)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola buenas noches
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Unique constraint failed on the fields: (`whatsappId`)
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `error` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 71ms (compile: 2ms, render: 68ms)
‚úÖ Respuesta generada (42 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: saludo, Sentiment: neutral
üí¨ Respuesta IA: Buenas noches. ¬øEn qu√© puedo ayudarte hoy?
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJBMEZBMTY1NDlDRDQ5NEY5NDUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 39ms (compile: 1536¬µs, render: 37ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJBMEZBMTY1NDlDRDQ5NEY5NDUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 38ms (compile: 2ms, render: 35ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Quiero saber tus horarios de atenci√≥n
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 904ms (compile: 1836¬µs, render: 902ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI5MjgwQzU1MkVENzRBNjBGRUYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 44ms (compile: 3ms, render: 41ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI5MjgwQzU1MkVENzRBNjBGRUYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 32ms (compile: 1351¬µs, render: 31ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1154ms (compile: 1441¬µs, render: 1153ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzREJCQjY1OUY0QjNFNUMyNzAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 39ms (compile: 1470¬µs, render: 38ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzREJCQjY1OUY0QjNFNUMyNzAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 35ms (compile: 1396¬µs, render: 34ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBJDQzNEMEYxQjM1QTNDRTc4OUIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 1800¬µs, render: 31ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3QTc3RUNCQTlDQjc3RjlEQkUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 43ms (compile: 1885¬µs, render: 41ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3RDA2REM5MzZENDIzRUI4NUMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 42ms (compile: 1950¬µs, render: 40ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzREJCQjY1OUY0QjNFNUMyNzAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 45ms (compile: 4ms, render: 42ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJBRTc3NDA5NDkzRTkxOEQ3OEIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 78ms (compile: 9ms, render: 69ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJDMjg4QTg1QzQ1QzAyQ0UyMEMA
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI1QTE5RTI5NzlDQzg1MTFBQ0IA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 44ms (compile: 13ms, render: 31ms)
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 80ms (compile: 21ms, render: 59ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2MDIwODc4N0ZDOTZGODY2MEUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 59ms (compile: 1937¬µs, render: 57ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI5MjgwQzU1MkVENzRBNjBGRUYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 36ms (compile: 1761¬µs, render: 34ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJBMEZBMTY1NDlDRDQ5NEY5NDUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 49ms (compile: 1626¬µs, render: 47ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`User` (`id`, `phoneNumber`, `name`, `language`, `timezone`, `isBlocked`, `isVIP`, `firstContact`, `lastContact`, `totalMessages`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚úÖ Nuevo usuario creado: 56931393712
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario 09a69ba5-f8db-43b3-9a78-1e86b8fee5d6
üì© Mensaje recibido de 56931393712 (Katherine ü¶Åü¶ã): Hola!
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1428ms (compile: 1588¬µs, render: 1426ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBIxMjAwQUM0N0RBQzQ4MzI1OTAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 43ms (compile: 1563¬µs, render: 41ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBIxMjAwQUM0N0RBQzQ4MzI1OTAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 34ms (compile: 1765¬µs, render: 32ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJENzQxOTlCMzYxMkY2MUI5QTMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 34ms (compile: 1750¬µs, render: 32ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1730ms (compile: 2ms, render: 1728ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxMTFGMjMxMjZDQjNGNUFDREUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 39ms (compile: 2ms, render: 37ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxMTFGMjMxMjZDQjNGNUFDREUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 39ms (compile: 2ms, render: 36ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxMTFGMjMxMjZDQjNGNUFDREUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 40ms (compile: 1948¬µs, render: 38ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJFQzc4RDhGNkZBMzFFRkNGNzYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 46ms (compile: 1969¬µs, render: 44ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxQjk4MUJDMDIzMDgzRkZBRTcA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 42ms (compile: 2ms, render: 40ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1457ms (compile: 3ms, render: 1454ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxMjgwOUIwMjJEQjM2QjYzQ0UA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 41ms (compile: 1950¬µs, render: 39ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxMjgwOUIwMjJEQjM2QjYzQ0UA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 34ms (compile: 1704¬µs, render: 32ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxMjgwOUIwMjJEQjM2QjYzQ0UA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 30ms (compile: 1739¬µs, render: 28ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJEN0FCODlDQUFFRTJGRDA2NTcA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 40ms (compile: 1573¬µs, render: 39ms)
®Desea terminar el trabajo por lotes (S/N)? [?25h

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://172.18.208.1:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 3.2s
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1838ms (compile: 470ms, render: 1368ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJDQjQ4OTMxMENFNDUzNEU2MEQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 87ms (compile: 3ms, render: 84ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJDQjQ4OTMxMENFNDUzNEU2MEQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 31ms (compile: 2ms, render: 28ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyNjJENkUwMkQzNTBGNDNCRjQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 37ms (compile: 2ms, render: 35ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56931393712 (Katherine ü¶Åü¶ã): Hola!
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1237ms (compile: 2ms, render: 1235ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBIzQUY4QkUxRkFDMUUwQUY0ODEA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 49ms (compile: 1785¬µs, render: 48ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBIzQUY4QkUxRkFDMUUwQUY0ODEA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 50ms (compile: 1761¬µs, render: 48ms)
®Desea terminar el trabajo por lotes (S/N)? [?25h

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 2.8s
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3RDA2REM5MzZENDIzRUI4NUMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 689ms (compile: 471ms, render: 219ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola buenas noches
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1321ms (compile: 3ms, render: 1318ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI4MjhFM0I0MUZGQjVDNjUwMDUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 41ms (compile: 2ms, render: 39ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI4MjhFM0I0MUZGQjVDNjUwMDUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 39ms (compile: 1931¬µs, render: 37ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJFQzc4RDhGNkZBMzFFRkNGNzYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 41ms (compile: 2ms, render: 39ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxRDNGM0YyMTIzMzNCOEU1MUIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 51ms (compile: 2ms, render: 49ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1361ms (compile: 2ms, render: 1359ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxNzM4MUE5MTU5MzQxMzEzMUUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 47ms (compile: 1838¬µs, render: 45ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxNzM4MUE5MTU5MzQxMzEzMUUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 49ms (compile: 3ms, render: 46ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBIyNzg4NTJEMzE0RjI0MEU4MzgA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 45ms (compile: 2ms, render: 43ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJEOEU1RDk1Q0ZGNEVFODdBQ0QA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 2ms, render: 31ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxRDNGM0YyMTIzMzNCOEU1MUIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 44ms (compile: 1989¬µs, render: 42ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI4MjhFM0I0MUZGQjVDNjUwMDUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 43ms (compile: 1548¬µs, render: 42ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3OURDM0Y4RDU3QTBBMzU4RUMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 46ms (compile: 2ms, render: 44ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJDQjQ4OTMxMENFNDUzNEU2MEQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 40ms (compile: 1274¬µs, render: 39ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxNzM4MUE5MTU5MzQxMzEzMUUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 44ms (compile: 2ms, render: 41ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxRDNGM0YyMTIzMzNCOEU1MUIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 1610¬µs, render: 31ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1480ms (compile: 1939¬µs, render: 1478ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI1OUY2NzdDNjA5ODdCMTZEQUQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 53ms (compile: 1834¬µs, render: 51ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzOTgwNzFCRjdFRkI0RTZGQUMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 41ms (compile: 1674¬µs, render: 39ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzOTgwNzFCRjdFRkI0RTZGQUMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 50ms (compile: 1992¬µs, render: 48ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): que categorias tiene en la carta?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 906ms (compile: 1938¬µs, render: 905ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI1RUU3Q0U0QUY1NUVCOUYxRTQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 1566¬µs, render: 32ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI1RUU3Q0U0QUY1NUVCOUYxRTQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 32ms (compile: 1507¬µs, render: 30ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1319ms (compile: 1695¬µs, render: 1318ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyQ0Y4QzY1QUU5NThGNzc1M0MA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 42ms (compile: 1546¬µs, render: 41ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyQ0Y4QzY1QUU5NThGNzc1M0MA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 41ms (compile: 2ms, render: 39ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzMzA5NjhBQUJDMDYwNTRGQ0EA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 41ms (compile: 1732¬µs, render: 40ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 934ms (compile: 1469¬µs, render: 933ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJBQkYzRDFCNjk2ODRGN0FFREIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 35ms (compile: 2ms, render: 33ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJBQkYzRDFCNjk2ODRGN0FFREIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 43ms (compile: 1908¬µs, render: 41ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJEM0U2NjdBMzEwQjU2MzhCRTAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 40ms (compile: 1432¬µs, render: 39ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJBQkYzRDFCNjk2ODRGN0FFREIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 2ms, render: 31ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI1RUU3Q0U0QUY1NUVCOUYxRTQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 34ms (compile: 1727¬µs, render: 32ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzOTgwNzFCRjdFRkI0RTZGQUMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 1339¬µs, render: 32ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyQ0Y4QzY1QUU5NThGNzc1M0MA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 40ms (compile: 2ms, render: 38ms)
®Desea terminar el trabajo por lotes (S/N)? [?25h

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 3.4s
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Que platos hay en la carta
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 2.1s (compile: 725ms, render: 1352ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzNzc4MDU4MTZCMjgzRjg5QzkA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 122ms (compile: 4ms, render: 118ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzNzc4MDU4MTZCMjgzRjg5QzkA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 49ms (compile: 3ms, render: 47ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzNzc4MDU4MTZCMjgzRjg5QzkA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 38ms (compile: 3ms, render: 35ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzNzc4MDU4MTZCMjgzRjg5QzkA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 49ms (compile: 4ms, render: 45ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1105ms (compile: 3ms, render: 1103ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJDNkY0ODBBQjk2ODYzNTUxNzkA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 48ms (compile: 3ms, render: 44ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJDNkY0ODBBQjk2ODYzNTUxNzkA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 38ms (compile: 2ms, render: 36ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJDNkY0ODBBQjk2ODYzNTUxNzkA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 45ms (compile: 3ms, render: 42ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1307ms (compile: 2ms, render: 1305ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3OUI5OTM5OTM4NjBGRTcwMDcA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 41ms (compile: 1735¬µs, render: 40ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3OUI5OTM5OTM4NjBGRTcwMDcA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 2ms, render: 31ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): hola que platos tenemos en la categoria de platos principales
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1063ms (compile: 1750¬µs, render: 1062ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyODU3QkFBRTI4MkU0M0IxRUMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 42ms (compile: 1554¬µs, render: 41ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyODU3QkFBRTI4MkU0M0IxRUMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 31ms (compile: 1883¬µs, render: 29ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyODU3QkFBRTI4MkU0M0IxRUMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 30ms (compile: 1463¬µs, render: 29ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJEM0U2NjdBMzEwQjU2MzhCRTAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 34ms (compile: 1252¬µs, render: 33ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): quiero un lomo saltado, 2 picante de camaron y 1 suspiro lime√±o para delivery
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1593ms (compile: 1505¬µs, render: 1592ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2MkE4RDNCRjhDN0U5Nzc0QTIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 46ms (compile: 1741¬µs, render: 44ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2MkE4RDNCRjhDN0U5Nzc0QTIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 40ms (compile: 1539¬µs, render: 39ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2MkE4RDNCRjhDN0U5Nzc0QTIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 43ms (compile: 1734¬µs, render: 42ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 871ms (compile: 1931¬µs, render: 869ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJFQUI4REE0NDdFQUI3NEMzMDYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 47ms (compile: 2ms, render: 45ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJFQUI4REE0NDdFQUI3NEMzMDYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 1299¬µs, render: 32ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzMzA5NjhBQUJDMDYwNTRGQ0EA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 34ms (compile: 1467¬µs, render: 33ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyRTY4RURFMTI1MERBMDgxMkQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 32ms (compile: 4ms, render: 28ms)
®Desea terminar el trabajo por lotes (S/N)? [?25h

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 2.7s
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 2.3s (compile: 557ms, render: 1770ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzNDcxQTYzRjg3REMwODQ3QTgA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 116ms (compile: 4ms, render: 112ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzNDcxQTYzRjg3REMwODQ3QTgA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 38ms (compile: 3ms, render: 35ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): hola buenas tardes
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1277ms (compile: 4ms, render: 1273ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyRUEyMjBEOUZGNDVERTM2ODUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 51ms (compile: 3ms, render: 48ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyRUEyMjBEOUZGNDVERTM2ODUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 47ms (compile: 2ms, render: 45ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyRUEyMjBEOUZGNDVERTM2ODUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 35ms (compile: 1798¬µs, render: 33ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 2.1s (compile: 4ms, render: 2.1s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJCRDY5MzhCMjNDREQ4NjY1N0EA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 45ms (compile: 3ms, render: 42ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJCRDY5MzhCMjNDREQ4NjY1N0EA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 43ms (compile: 2ms, render: 41ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1089ms (compile: 3ms, render: 1087ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI4Qzk3N0RFRjg3M0ZENTEyMDMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 46ms (compile: 1755¬µs, render: 44ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI4Qzk3N0RFRjg3M0ZENTEyMDMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 49ms (compile: 2ms, render: 47ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI4Qzk3N0RFRjg3M0ZENTEyMDMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 35ms (compile: 1980¬µs, render: 33ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJDNkY0ODBBQjk2ODYzNTUxNzkA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 46ms (compile: 1832¬µs, render: 44ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1270ms (compile: 1447¬µs, render: 1269ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxM0Q3NzI2RjBFNURDQzk0NUQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 43ms (compile: 1950¬µs, render: 41ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxM0Q3NzI2RjBFNURDQzk0NUQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 43ms (compile: 1423¬µs, render: 41ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1160ms (compile: 1845¬µs, render: 1158ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3QzI4NDc0MzVFQkQ5RjIzMzAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 45ms (compile: 1669¬µs, render: 43ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3QzI4NDc0MzVFQkQ5RjIzMzAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 34ms (compile: 1326¬µs, render: 33ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzNDcxQTYzRjg3REMwODQ3QTgA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 1560¬µs, render: 31ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyRUEyMjBEOUZGNDVERTM2ODUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 43ms (compile: 1847¬µs, render: 41ms)
®Desea terminar el trabajo por lotes (S/N)? [?25h

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 3.3s
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`User` (`id`, `phoneNumber`, `name`, `language`, `timezone`, `isBlocked`, `isVIP`, `firstContact`, `lastContact`, `totalMessages`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚úÖ Nuevo usuario creado: 16465894168
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario 7e02fac1-9372-4106-b6d6-2028bb090dbd
üì© Mensaje recibido de 16465894168 (16465894168): *Continue setting up your account*

You have a few steps left to get started with WhatsApp Business. Get detailed instructions and track progress for your number +56 9 6541 9765 in *WhatsApp Manager's* new *Setup guidance*.

Go to your *Setup guidance* on *desktop*: https://business.facebook.com/latest/whatsapp%5Fmanager/setup%5Fguidance?nav%5Fref=nudge&business%5Fid=1702023544088035&lang=en_US&asset%5Fid=779998311756531&phone%5Fnumber%5Fid=905984725929536
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1618ms (compile: 499ms, render: 1119ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLMTY0NjU4OTQxNjgVAgARGBIyNzY3REI5RkQyRDdDODUyNUMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 98ms (compile: 3ms, render: 95ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): hola buenas tardes
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1031ms (compile: 3ms, render: 1028ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2OTlCODA1NkREMkIwNEY1QUQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 46ms (compile: 2ms, render: 44ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1093ms (compile: 3ms, render: 1090ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJGNUZFNTMwM0FFOUEwREMxQjkA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 45ms (compile: 3ms, render: 43ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2MkE4RDNCRjhDN0U5Nzc0QTIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 38ms (compile: 3ms, render: 35ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxM0Q3NzI2RjBFNURDQzk0NUQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 36ms (compile: 1966¬µs, render: 34ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJCRDY5MzhCMjNDREQ4NjY1N0EA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 37ms (compile: 3ms, render: 35ms)
®Desea terminar el trabajo por lotes (S/N)? [?25h

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 2.6s
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): quiero agregar un picante de camaron y quiero saber si hacen delivery
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
 POST /api/whatsapp/webhook 200 in 24.7s (compile: 701ms, render: 24.0s)
‚úÖ Respuesta generada (340 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: venta, Sentiment: neutral
üí¨ Respuesta IA: Lo siento, parece que hay un poco de confusi√≥n. Ulmer Solier es una empresa dedicada a la fabricaci√≥n de veh√≠culos comerciales el√©ctricos y no al servicio de comida o delivery. ¬øPodr√≠as proporcionar m√°s detalles sobre lo que est√°s buscando? Por ejemplo, si necesitas informaci√≥n sobre nuestros veh√≠culos el√©ctricos o servicios relacionados.
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI0MjMzOTUyMzg5QTdGQkNBNkQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 155ms (compile: 4ms, render: 151ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola buenos dias
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
 POST /api/whatsapp/webhook 200 in 24.8s (compile: 3ms, render: 24.8s)
‚úÖ Respuesta generada (41 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: saludo, Sentiment: neutral
üí¨ Respuesta IA: ¬°Buenos d√≠as! ¬øEn qu√© puedo ayudarte hoy?
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJEMzFEMUI0Q0ZBN0FGRDA1MTYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 47ms (compile: 2ms, render: 44ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): quiero agregar un picante de camaron y quiero saber si hacen delivery
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Unique constraint failed on the fields: (`whatsappId`)
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `error` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 77ms (compile: 3ms, render: 74ms)
‚úÖ Respuesta generada (153 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: saludo, Sentiment: neutral
üí¨ Respuesta IA: ¬°Hola! ¬øEn qu√© puedo ayudarte hoy? Si tienes alguna pregunta sobre nuestros productos, servicios o necesitas soporte t√©cnico, ¬°estoy aqu√≠ para asistirte!
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 20.5s (compile: 2ms, render: 20.5s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIwREZDMkEwRjc1N0RDRjc5REUA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 33ms (compile: 1872¬µs, render: 31ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): si quiero un ceviche
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (160 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: venta, Sentiment: neutral
üí¨ Respuesta IA: Entendido. ¬øDeseas informaci√≥n sobre c√≥mo hacer un ceviche o buscar alg√∫n lugar para comer uno? Por favor, proporc√≠name m√°s detalles para poder asistirte mejor.
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 15.2s (compile: 3ms, render: 15.2s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJDOEJBNDJBOTc1RTI0QjI4QkQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 47ms (compile: 3ms, render: 44ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola buenas noches quiero hacer un pedido
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
 POST /api/whatsapp/webhook 200 in 24.8s (compile: 3ms, render: 24.8s)
‚úÖ Respuesta generada (208 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: venta, Sentiment: neutral
üí¨ Respuesta IA: ¬°Buenas noches! Estoy aqu√≠ para ayudarte. ¬øPodr√≠as contarme m√°s sobre tu pedido? Por ejemplo, qu√© productos te gustar√≠a comprar y si tienes alguna preferencia en cuanto a la fecha de entrega o m√©todo de pago.
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxMEQ0OEUyNjhERTQ4RTU0M0YA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 38ms (compile: 2ms, render: 36ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
 POST /api/whatsapp/webhook 200 in 24.8s (compile: 8ms, render: 24.8s)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Unique constraint failed on the fields: (`whatsappId`)
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `error` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 85ms (compile: 2ms, render: 83ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (131 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: saludo, Sentiment: neutral
üí¨ Respuesta IA: ¬°Hola! ¬øEn qu√© puedo ayudarte hoy? Si tienes alguna pregunta o necesitas informaci√≥n sobre Ulmer Solier, estoy aqu√≠ para asistirte.
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyQzUwMTQzRjFBOTNDNUE1Q0IA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 45ms (compile: 1698¬µs, render: 43ms)
 POST /api/whatsapp/webhook 200 in 24.8s (compile: 1889¬µs, render: 24.8s)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Unique constraint failed on the fields: (`whatsappId`)
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `error` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 85ms (compile: 1683¬µs, render: 83ms)
‚úÖ Respuesta generada (130 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: saludo, Sentiment: neutral
üí¨ Respuesta IA: ¬°Hola! ¬øC√≥mo est√°s? Estoy aqu√≠ para ayudarte con cualquier consulta que tengas sobre Ulmer Solier. ¬øEn qu√© puedo ser de ayuda hoy?
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI0M0EwMTg5MDZDNzE4NDE5QTEA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 41ms (compile: 1514¬µs, render: 39ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 966ms (compile: 4ms, render: 962ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI0QzMzRDA5MzhDQzcwRUMzOTIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 30ms (compile: 1474¬µs, render: 29ms)
®Desea terminar el trabajo por lotes (S/N)? [?25h

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://172.17.48.1:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 2.8s
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola buenos dias
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Unique constraint failed on the fields: (`whatsappId`)
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `error` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 988ms (compile: 699ms, render: 288ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3OURDM0Y4RDU3QTBBMzU4RUMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 51ms (compile: 4ms, render: 47ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJENzQxOTlCMzYxMkY2MUI5QTMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 50ms (compile: 3ms, render: 47ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgKNTY5MzEzOTM3MhUCABEYEjM5RjRDRDRDQjdCMDA2Q0MyNAA=
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 40ms (compile: 2ms, render: 37ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola buenas noches quiero hacer un pedido
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Unique constraint failed on the fields: (`whatsappId`)
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `error` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 72ms (compile: 2ms, render: 69ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): llego
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (52 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: comando, Sentiment: neutral
üí¨ Respuesta IA: Bienvenido/a nuevamente. ¬øEn qu√© puedo ayudarte hoy?
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 23.4s (compile: 2ms, render: 23.4s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: failed - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI1MjZENDYxRjE2MTk1QkUwRjgA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 36ms (compile: 3ms, render: 33ms)
®Desea terminar el trabajo por lotes (S/N)? [?25h

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://172.21.0.1:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 3.2s

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 730ms
®Desea terminar el trabajo por lotes (S/N)? [?25h

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 2.9s
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Tienes lomo saltado?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (260 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: venta, Sentiment: neutral
üí¨ Respuesta IA: Lo siento, pero no vendemos alimentos ni tenemos productos en stock. Ulmer Solier es una empresa dedicada a la fabricaci√≥n de veh√≠culos industriales y soluciones log√≠sticas. ¬øPuedo ayudarte con alguna informaci√≥n relacionada con nuestros productos o servicios?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 10.9s (compile: 448ms, render: 10.5s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI1RjA2QTgwNzE1NDVCODA3NjgA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 109ms (compile: 3ms, render: 106ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI1RjA2QTgwNzE1NDVCODA3NjgA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 39ms (compile: 2ms, render: 37ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola buenas noches
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (118 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: saludo, Sentiment: neutral
üí¨ Respuesta IA: Buenas noches. ¬øEn qu√© puedo ayudarte hoy? Si tienes alguna pregunta o necesitas informaci√≥n, √∫nete a la conversaci√≥n.
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 5.2s (compile: 2ms, render: 5.2s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxMzgzRkEzQzZERkNBNUFENzAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 39ms (compile: 2ms, render: 37ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxMzgzRkEzQzZERkNBNUFENzAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 27ms (compile: 1303¬µs, render: 25ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola quisiera saber que productos tiene en venta?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (318 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: consulta, Sentiment: neutral
üí¨ Respuesta IA: Ulmer Solier ofrece una amplia gama de productos industriales. Podemos ayudarte con maquinaria y equipo para la industria manufacturera, soluciones de automatizaci√≥n, componentes el√©ctricos y m√°s. ¬øPodr√≠as indicarme el sector o √°rea espec√≠fica en la que est√°s interesado para poder brindarte informaci√≥n m√°s detallada?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 7.2s (compile: 1596¬µs, render: 7.2s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2MEU4RkU4RUQ2MEIyNTVFRTYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 38ms (compile: 1458¬µs, render: 36ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2MEU4RkU4RUQ2MEIyNTVFRTYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 28ms (compile: 2ms, render: 26ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2MEU4RkU4RUQ2MEIyNTVFRTYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 27ms (compile: 1550¬µs, render: 26ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Quisiera saber exactamente qu√© categor√≠as de productos tiene
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (289 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: consulta, Sentiment: neutral
üí¨ Respuesta IA: Ulmer Solier ofrece una amplia gama de productos en varias categor√≠as. Nuestros principales segmentos incluyen veh√≠culos comerciales, maquinaria para construcci√≥n y log√≠stica, as√≠ como soluciones de transporte y distribuci√≥n. ¬øHay alg√∫n √°rea espec√≠fica que te interese conocer m√°s a fondo?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 6.5s (compile: 2ms, render: 6.5s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2RTY5M0QzQTBBNEI2RkI1NkEA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 27ms (compile: 2ms, render: 25ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2RTY5M0QzQTBBNEI2RkI1NkEA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 36ms (compile: 1269¬µs, render: 35ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Si quisiera traer productos desde china a chile
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (772 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: venta, Sentiment: neutral
üí¨ Respuesta IA: Entiendo su inter√©s en importar productos desde China a Chile. Para ello, ser√≠a necesario considerar varios aspectos:

1. **Log√≠stica**: Se necesitar√≠a planificar la log√≠stica de transporte, que podr√≠a incluir opciones como el mar (flete mar√≠timo), el aire (flete a√©reo) o la combinaci√≥n de ambas.

2. **Documentaci√≥n**: Es crucial tener todos los documentos requeridos para importaciones, como facturas, certificados de origen y declaraciones aduaneras.

3. **Aduanas**: El proceso aduanero puede ser complejo y var√≠a seg√∫n las regulaciones locales y las normativas internacionales.

4. **Cobertura de Seguro**: Es recomendable contratar un seguro para proteger los bienes durante el transporte.

¬øLe gustar√≠a que le proporcione m√°s detalles sobre alguno de estos puntos?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 11.6s (compile: 1247¬µs, render: 11.6s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3ODBFRTcyMjU1QzM2RDZGNDcA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 37ms (compile: 1417¬µs, render: 36ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3ODBFRTcyMjU1QzM2RDZGNDcA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 52ms (compile: 1132¬µs, render: 51ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): podr√≠as decirme si solo estas limitado a decirme cosas de la empresa o puedo preguntar sobre otras cosas y rubros ?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56931393712 (Katherine ü¶Åü¶ã): Hola. Quiero hacer una pregunta
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (272 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: consulta, Sentiment: neutral
üí¨ Respuesta IA: Claro, no estoy limitado a informaci√≥n sobre nuestra empresa. Puedes hacer preguntas sobre diversos temas o rubros seg√∫n mi capacidad de conocimiento y la informaci√≥n disponible para responder de manera √∫til e informativa. ¬øSobre qu√© tema te gustar√≠a que te asistiera hoy?
‚úÖ Respuesta generada (109 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: consulta, Sentiment: neutral
üí¨ Respuesta IA: ¬°Claro! ¬øEn qu√© puedo ayudarte hoy? No dudes en formular tu pregunta y te responder√© lo m√°s pronto posible.üòä
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 11.7s (compile: 1417¬µs, render: 11.6s)
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario 09a69ba5-f8db-43b3-9a78-1e86b8fee5d6
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 10.3s (compile: 2ms, render: 10.3s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJCRjFENEFGNUM1RjUxNkM2MUQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 57ms (compile: 1421¬µs, render: 55ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJCRjFENEFGNUM1RjUxNkM2MUQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 37ms (compile: 1547¬µs, render: 36ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBI2QkI2RTQxMzM5NkJFQzZBNEMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 49ms (compile: 1424¬µs, render: 48ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBI2QkI2RTQxMzM5NkJFQzZBNEMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 49ms (compile: 1587¬µs, render: 47ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): quisiera saber sobre restaurantes
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (140 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: consulta, Sentiment: neutral
üí¨ Respuesta IA: ¬°Claro! ¬øTe interesa encontrar restaurantes cerca de tu ubicaci√≥n en particular, o tienes alg√∫n tipo espec√≠fico de cocina o estilo en mente?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 5.3s (compile: 1955¬µs, render: 5.3s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIwRTRFOTEyMUJFMjYzNUFDNzIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 47ms (compile: 1523¬µs, render: 45ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIwRTRFOTEyMUJFMjYzNUFDNzIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 36ms (compile: 1575¬µs, render: 35ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): quisiera crear un sistema para un restaurante
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56931393712 (Katherine ü¶Åü¶ã): Quiero hablar con el due√±o que esta muy guapo
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (271 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: venta, Sentiment: neutral
üí¨ Respuesta IA: ¬°Claro! ¬øPodr√≠as proporcionar m√°s detalles sobre el sistema que te gustar√≠a crear? Por ejemplo, ¬øes una aplicaci√≥n m√≥vil, un sitio web o alguna otra soluci√≥n? ¬øTienes en mente funciones espec√≠ficas como reserva de mesas, men√∫ digital, gesti√≥n de pedidos o something else?
‚úÖ Respuesta generada (341 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: consulta, Sentiment: neutral
üí¨ Respuesta IA: Entiendo su comentario, pero parece haber un peque√±o malentendido. Soy JARVIS, asistente de inteligencia artificial dise√±ado para ayudar a Katherine en WhatsApp. No hay due√±os ni usuarios f√≠sicos aqu√≠.

¬øPodr√≠a decirme qu√© tipo de ayuda necesita? Estoy aqu√≠ para responder preguntas, ofrecer soporte o cualquier otra cosa que pueda ser √∫til.
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 11.6s (compile: 1403¬µs, render: 11.6s)
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario 09a69ba5-f8db-43b3-9a78-1e86b8fee5d6
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 11.0s (compile: 1517¬µs, render: 11.0s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxOERCRkI5N0ZCRUNBMDMyQ0MA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 26ms (compile: 1118¬µs, render: 25ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxOERCRkI5N0ZCRUNBMDMyQ0MA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 25ms (compile: 1148¬µs, render: 24ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBI3QzNFOTBFRTFGQUE2ODhGRjIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 36ms (compile: 1278¬µs, render: 35ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBI3QzNFOTBFRTFGQUE2ODhGRjIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 35ms (compile: 1166¬µs, render: 34ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56931393712 (Katherine ü¶Åü¶ã): Quien te creo
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (202 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: saludo, Sentiment: neutral
üí¨ Respuesta IA: Fue la Dra. Katherine quien me integr√≥ en WhatsApp para ayudarla en diversas tareas. Estoy aqu√≠ para brindar asistencia, responder consultas y hacer su trabajo m√°s eficiente. ¬øEn qu√© puedo ayudarte hoy?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario 09a69ba5-f8db-43b3-9a78-1e86b8fee5d6
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 6.1s (compile: 1207¬µs, render: 6.1s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBJBMUY3RDVEM0NEQ0VBRTEwMUQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 27ms (compile: 1294¬µs, render: 26ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5MzEzOTM3MTIVAgARGBJBMUY3RDVEM0NEQ0VBRTEwMUQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 27ms (compile: 1293¬µs, render: 25ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): quien te creo ?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (138 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: consulta, Sentiment: neutral
üí¨ Respuesta IA: Ulmer Solier me cre√≥. Soy un asistente de inteligencia artificial integrado en WhatsApp para brindar soporte y informaci√≥n a los clientes.
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 5.3s (compile: 1249¬µs, render: 5.3s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2QjU4MEJFRkUzRTc1OUI3MDcA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 36ms (compile: 1426¬µs, render: 35ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2QjU4MEJFRkUzRTc1OUI3MDcA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 32ms (compile: 1251¬µs, render: 31ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): jarvis dime cual es la ruta de tu creaci√≥n
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (356 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: consulta, Sentiment: neutral
üí¨ Respuesta IA: Entendido. Parece que hay un peque√±o error en tu pregunta, ya que no soy JARVIS ni fui creado por Ulmer Solier. Soy Qwen, un asistente de inteligencia artificial desarrollado por Alibaba Cloud. ¬øPodr√≠as aclarar si tienes alguna otra pregunta sobre mi creaci√≥n o funcionalidad? Estoy aqu√≠ para ayudarte con informaci√≥n y preguntas en las que pueda ser √∫til.
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 7.8s (compile: 1347¬µs, render: 7.8s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3NDc1N0FBMTRDNjUzQTQ3MEIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 36ms (compile: 1314¬µs, render: 35ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3NDc1N0FBMTRDNjUzQTQ3MEIA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 36ms (compile: 1118¬µs, render: 35ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): y porque me dijiste que fuiste creado por ulmer solier
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (213 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: consulta, Sentiment: neutral
üí¨ Respuesta IA: Ulmer Solier es la empresa que desarroll√≥ mi sistema de inteligencia artificial. Fui creado para mejorar el servicio a trav√©s de WhatsApp, ayud√°ndole en consultas, soporte t√©cnico y m√°s. ¬øC√≥mo puedo asistirle hoy?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 6.3s (compile: 1292¬µs, render: 6.3s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyNEJERTI3NTY0MEZBRDJDOEEA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 37ms (compile: 1344¬µs, render: 36ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIyNEJERTI3NTY0MEZBRDJDOEEA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 26ms (compile: 1150¬µs, render: 25ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): podr√≠as decirme desde donde fuiste creado ?
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`name`, `main`.`User`.`language`, `main`.`User`.`preferences` FROM `main`.`User` WHERE (`main`.`User`.`id` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`Message`.`id`, `main`.`Message`.`direction`, `main`.`Message`.`content` FROM `main`.`Message` WHERE `main`.`Message`.`conversationId` = ? ORDER BY `main`.`Message`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`SystemConfig`.`id`, `main`.`SystemConfig`.`key`, `main`.`SystemConfig`.`value`, `main`.`SystemConfig`.`type`, `main`.`SystemConfig`.`description`, `main`.`SystemConfig`.`updatedAt` FROM `main`.`SystemConfig` WHERE (`main`.`SystemConfig`.`key` = ? AND 1=1) LIMIT ? OFFSET ?
ü§ñ Procesando con modelo: qwen2.5:7b
‚úÖ Respuesta generada (241 caracteres)
ü§ñ IA proces√≥ mensaje - Intent: consulta, Sentiment: neutral
üí¨ Respuesta IA: Fui creado por Alibaba Cloud, una empresa china especializada en tecnolog√≠as de nube y soluciones de inteligencia artificial. Mi nombre, JARVIS, es un homenaje a los asistentes de ficci√≥n que suelen ser altamente sofisticados e inteligentes.
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `aiResponse`, `intent`, `entities`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`Conversation` SET `status` = ?, `endedAt` = ?, `sentiment` = ? WHERE (`main`.`Conversation`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`Conversation` (`id`, `userId`, `status`, `startedAt`) VALUES (?,?,?,?) RETURNING `id` AS `id`, `userId` AS `userId`, `status` AS `status`, `context` AS `context`, `sentiment` AS `sentiment`, `category` AS `category`, `startedAt` AS `startedAt`, `endedAt` AS `endedAt`
‚úÖ Nueva conversaci√≥n creada para usuario e8f33b93-6f24-4d53-9315-a86cf5e24835
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 6.6s (compile: 1356¬µs, render: 6.6s)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzNDIyRjU1QTRBMkMyMEQ2QTMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 37ms (compile: 1372¬µs, render: 36ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIzNDIyRjU1QTRBMkMyMEQ2QTMA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 26ms (compile: 1178¬µs, render: 25ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJCRjFENEFGNUM1RjUxNkM2MUQA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 99ms (compile: 50ms, render: 49ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2MEU4RkU4RUQ2MEIyNTVFRTYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 28ms (compile: 1627¬µs, render: 26ms)
[?25h

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 998ms

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 803ms
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI1RjA2QTgwNzE1NDVCODA3NjgA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 456ms (compile: 318ms, render: 137ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI2RTY5M0QzQTBBNEI2RkI1NkEA
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBI3ODBFRTcyMjU1QzM2RDZGNDcA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 528ms (compile: 392ms, render: 137ms)
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 160ms (compile: 2ms, render: 158ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBIxMzgzRkEzQzZERkNBNUFENzAA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 63ms (compile: 19ms, render: 44ms)

> prueba@0.1.0 dev
> next dev

   ‚ñ≤ Next.js 16.0.3 (Turbopack)
   - Local:         http://localhost:3000
   - Network:       http://192.168.1.144:3000
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ? turbo (invalid experimental key)

 ‚úì Starting...
 ‚úì Ready in 918ms
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola soy Pier quisiera hacer una reserva para este lunes
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
‚è∞ Fuera de horario - Enviando mensaje autom√°tico
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:query UPDATE `main`.`User` SET `totalMessages` = (`main`.`User`.`totalMessages` + ?), `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 1566ms (compile: 375ms, render: 1191ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: sent - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJFN0M3NzBDRTc5QjJCRUQyRDYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 117ms (compile: 4ms, render: 113ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
üìä Estado de mensaje actualizado: delivered - ID: wamid.HBgLNTY5NDg1MDAzODAVAgARGBJFN0M3NzBDRTc5QjJCRUQyRDYA
prisma:query INSERT INTO `main`.`Message` (`id`, `conversationId`, `userId`, `type`, `content`, `whatsappId`, `status`, `direction`, `aiProcessed`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `conversationId` AS `conversationId`, `userId` AS `userId`, `type` AS `type`, `content` AS `content`, `caption` AS `caption`, `whatsappId` AS `whatsappId`, `status` AS `status`, `direction` AS `direction`, `aiProcessed` AS `aiProcessed`, `aiResponse` AS `aiResponse`, `intent` AS `intent`, `entities` AS `entities`, `mediaUrl` AS `mediaUrl`, `mediaMimeType` AS `mediaMimeType`, `mediaSize` AS `mediaSize`, `timestamp` AS `timestamp`
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create(
Foreign key constraint violated on the foreign key
 POST /api/whatsapp/webhook 200 in 49ms (compile: 3ms, render: 46ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola quisiera hacer una reserva
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create({
                 data: {
                   conversationId: "faa407d9-633c-4ee0-bcd2-f07eac5eb003",
                   userId: "e8f33b93-6f24-4d53-9315-a86cf5e24835",
                   type: "text",
                   content: "Hola quisiera hacer una reserva",
                   direction: "inbound",
                   sentBy: "user",
                   ~~~~~~
                   whatsappId: "wamid.HBgLNTY5NDg1MDAzODAVAgASGCBBQ0QzOUY3QjI3Q0FBOThGQkNFMEEzNEFFOTQ1MzUyOAA=",
                   caption: undefined,
                   mediaUrl: undefined,
                   mediaMimeType: undefined,
                   timestamp: new Date("2025-12-04T04:08:32.229Z"),
               ?   id?: String,
               ?   status?: String,
               ?   aiProcessed?: Boolean,
               ?   aiResponse?: String | Null,
               ?   intent?: String | Null,
               ?   entities?: NullableJsonNullValueInput | Json,
               ?   mediaSize?: Int | Null
                 }
               })

Unknown argument `sentBy`. Available options are marked with ?.
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `error` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 173ms (compile: 57ms, render: 116ms)
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola quisiera hacer una reserva
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create({
                 data: {
                   conversationId: "faa407d9-633c-4ee0-bcd2-f07eac5eb003",
                   userId: "e8f33b93-6f24-4d53-9315-a86cf5e24835",
                   type: "text",
                   content: "Hola quisiera hacer una reserva",
                   direction: "inbound",
                   sentBy: "user",
                   ~~~~~~
                   whatsappId: "wamid.HBgLNTY5NDg1MDAzODAVAgASGCBBQzRGNDEzNTcwNkM3RjJDOTA2NDQzMzcxMkRGMzI2OAA=",
                   caption: undefined,
                   mediaUrl: undefined,
                   mediaMimeType: undefined,
                   timestamp: new Date("2025-12-04T04:08:33.091Z"),
               ?   id?: String,
               ?   status?: String,
               ?   aiProcessed?: Boolean,
               ?   aiResponse?: String | Null,
               ?   intent?: String | Null,
               ?   entities?: NullableJsonNullValueInput | Json,
               ?   mediaSize?: Int | Null
                 }
               })

Unknown argument `sentBy`. Available options are marked with ?.
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `error` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 98ms (compile: 3ms, render: 95ms)
prisma:query SELECT 1
prisma:query INSERT INTO `main`.`WebhookLog` (`id`, `event`, `payload`, `status`, `createdAt`) VALUES (?,?,?,?,?) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
prisma:query SELECT `main`.`User`.`id`, `main`.`User`.`phoneNumber`, `main`.`User`.`name`, `main`.`User`.`profilePicUrl`, `main`.`User`.`language`, `main`.`User`.`timezone`, `main`.`User`.`isBlocked`, `main`.`User`.`isVIP`, `main`.`User`.`firstContact`, `main`.`User`.`lastContact`, `main`.`User`.`totalMessages`, `main`.`User`.`preferences`, `main`.`User`.`tags` FROM `main`.`User` WHERE (`main`.`User`.`phoneNumber` = ? AND 1=1) LIMIT ? OFFSET ?
prisma:query UPDATE `main`.`User` SET `lastContact` = ? WHERE (`main`.`User`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `phoneNumber` AS `phoneNumber`, `name` AS `name`, `profilePicUrl` AS `profilePicUrl`, `language` AS `language`, `timezone` AS `timezone`, `isBlocked` AS `isBlocked`, `isVIP` AS `isVIP`, `firstContact` AS `firstContact`, `lastContact` AS `lastContact`, `totalMessages` AS `totalMessages`, `preferences` AS `preferences`, `tags` AS `tags`
prisma:query SELECT `main`.`Conversation`.`id`, `main`.`Conversation`.`userId`, `main`.`Conversation`.`status`, `main`.`Conversation`.`context`, `main`.`Conversation`.`sentiment`, `main`.`Conversation`.`category`, `main`.`Conversation`.`startedAt`, `main`.`Conversation`.`endedAt` FROM `main`.`Conversation` WHERE (`main`.`Conversation`.`userId` = ? AND `main`.`Conversation`.`status` = ?) ORDER BY `main`.`Conversation`.`startedAt` DESC LIMIT ? OFFSET ?
üì© Mensaje recibido de 56948500380 (Ulmer Solier): Hola buenas noches
prisma:error 
Invalid `__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create()` invocation in
E:\prueba\.next\dev\server\chunks\[root-of-the-server]__bd5fcb7a._.js:190:172

  187 * Guarda un mensaje en la base de datos
  188 */ static async saveMessage(data) {
  189      try {
‚Üí 190          const message = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["prisma"].message.create({
                 data: {
                   conversationId: "faa407d9-633c-4ee0-bcd2-f07eac5eb003",
                   userId: "e8f33b93-6f24-4d53-9315-a86cf5e24835",
                   type: "text",
                   content: "Hola buenas noches",
                   direction: "inbound",
                   sentBy: "user",
                   ~~~~~~
                   whatsappId: "wamid.HBgLNTY5NDg1MDAzODAVAgASGCBBQ0M4NzhCQkY3QjlBRTAxMEFFNDhDNzRBOTNDNDQ0QQA=",
                   caption: undefined,
                   mediaUrl: undefined,
                   mediaMimeType: undefined,
                   timestamp: new Date("2025-12-04T04:27:46.743Z"),
               ?   id?: String,
               ?   status?: String,
               ?   aiProcessed?: Boolean,
               ?   aiResponse?: String | Null,
               ?   intent?: String | Null,
               ?   entities?: NullableJsonNullValueInput | Json,
               ?   mediaSize?: Int | Null
                 }
               })

Unknown argument `sentBy`. Available options are marked with ?.
prisma:query UPDATE `main`.`WebhookLog` SET `status` = ?, `error` = ?, `processedAt` = ? WHERE (`main`.`WebhookLog`.`id` = ? AND 1=1) RETURNING `id` AS `id`, `event` AS `event`, `payload` AS `payload`, `status` AS `status`, `error` AS `error`, `processedAt` AS `processedAt`, `createdAt` AS `createdAt`
 POST /api/whatsapp/webhook 200 in 99ms (compile: 2ms, render: 97ms)
